\section{Simulation Techniques and Physics Scenarios\label{simSetup}}

The simulation of background in the LHC can be very demanding in terms of CPU as detailed shower simulations have to be performed along several hundred meters or many millions of primaries have to be tracked to get sufficient particles leaking to collimators in IR1 or IR5 which by definition is many orders of magnitudes lower than protons hitting the primaries. Two simulation codes were used as main tools: SixTrack for particle tracking around the ring and \fluka~for particle showering.\\

 SixTrack is a particle tracking code that features multi-turn stability (symplecticity) for the full six dimensional phase-space. It is based on thin-lens optics (where elements have zero lengths and magnetic field strengths are split such that it is equal to the thick lens optics) and has its own Monte Carlo physics model available~\cite{K2Ref}. An extended version of SixTrack includes the LHC collimator model~\cite{SixTrackRef}, which has been used for our purposes.

To evaluate the contribution of background sources we use FLUKA~\cite{flukaRef1,flukaRef2}, a general purpose Monte Carlo generator, calculating particle interaction and transport within matter for a user-defined geometry. It uses modern physics models and experimental data as available by the Particle Data Group~\cite{pdgRef}.
We use a geometry built up to 550~m of the right side of IR1 for the present LHC machine (the layout is symmetric around the IP1), for HL-LHC scenarios the geometry reaches up the tertiary collimators of around 215~m. 


\subsection{Beam-Halo simulations}
The simulation is performed in two steps: First, we use SixTrack~\cite{SixTrackRef} to track halo proton distributions customised by the user through a magnetic field lattice, usually prepared using MadX (for more information see also~\cite{chiarasThesis}). The beam halo is usually simulated in horizontal (h) and vertical (v) distributions. When a collimator is hit, a built-in, recently updated Monte-Carlo model~\cite{claudiasThesis} decides on the physics process. Protons continue in the lattice until they dissociate in an inelastic interaction with the collimator material or (in a post-processing step) are lost on the aperture. As a result, loss locations around the ring can be identified and protons absorbed by the TCTs serve in second step as seeds in \fluka~to start off forced inelastic interactions.

When interacting with the jaw material of the TCTH or TCTV shower particles are created and stream towards the experiment. Every particle passing an imaginary (x,y)-plane at 22.6~m away from the IP, essentially between the triplet magnets and the TAS, is recorded and written out. The left plot of Fig.~\ref{tctHits} shows part of the \fluka~geometry and in green the hits in an horizontal collimator TCTH.4L1 with absorbed protons from an horizontal and vertical halo distribution. On the right of Fig.~\ref{tctHits} one can see how deep these positions are with respect to the jaw surface shown for the collimator pair of IR1. This depth distribution is shown here as an example and discussed in more detail together with the other simulation cases in Sec.~\ref{evolut}.

\begin{figure}%[!htb]
\begin{center}
\includegraphics[width=0.9\textwidth]{figures/IR1_layout_runII.pdf}
\end{center}
\vspace{-0.6cm}
 \caption{Machine layout for the nominal LHC (as in Run I and II) of the left side of IR1 with IP1 at s = 0 for the incoming beam. Highlighted are the tertiary collimators (TCT4) at around -147~m, TCLs are debris collimators for the outgoing beam.
  \label{nominalLHC_layout}}
\end{figure}

\begin{figure}%[!htb]
\begin{center}
  \includegraphics[width=0.4\textwidth]{figures/6500GeV/xz_6500GeV_b1_TCT4.pdf}
  \includegraphics[width=0.4\textwidth]{figures/6500GeV/inelposition_sum_HALOB1.pdf}
\end{center}
\vspace{-0.6cm}
 \caption{View in the (x,z)-plane of hits in TCTH from the Run~II halo simulation case zoomed into the inner collimator parts. The hits are all contained within the collimator jaws and were obtained by SixTrack and transformed to the positions of the TCT in the \fluka~coordinates.
  \label{tctHits}}
\end{figure}


\subsection{Beam-Gas simulations}
Beam-gas interactions were simulated with \fluka~using a detailed geometry up to the arc. % for Run I and Run II which goes up to 550~m, but with different magnetic fields for a 4 TeV and a 6.5 TeV proton beam and the respective optics.
 Protons were forced to undergo an inelastic interaction with residual gas molecules on positions on the ideal orbit. A new technique used here includes the variation of the transverse beam size which in particular is large just before the triplet when the beam is squeezed for collisions, more details on that is given in Sec.~\ref{beamgasBS}. 

The sampling positions were read into \fluka~and like for the beam-halo simulations each shower particle reaching the interface plane at 22.6~m is used to dump information about fluxes towards the experiment. 

Simulations can either be done normalising the results distribution in a subsequent step or at run time. The advantage of the first method is distributions can be normalised to several pressure profiles given the information is kept of the origin of creation of the particle at the interface plane. More details are given directly per case.% The normalisation with the intensity and pressure profile was done as follows: A representative fill of the run was selected and gauge data is used in the pressure simulation in order to interpolate in between the measurement points and also estimate the contribution per molecule type using the VAcuum Simulation COde, VASCO. The result file can then be re-weighted with the pressure in a subsequent step, thus the unweighted results correspond to a flat pressure. 


%Normalisation to the pressure proton-nitrogen interactions are simulated in order to scale in a second step the contributions to the pressure profile usually expressed in $N_2$-equivalent.

\subsection{Run I and Run II Simulation Cases}
For Run I and II real physics configurations of the LHC we used as in 2012 and 2015. At 4~TeV in 2012, the optics were $\beta^* = 60$ cm and TCT collimator settings in IR1/IR5 TCTs were set to 9~$\sigma$~\cite{parametersRun1}. For Run II, the optics changed to $\beta^* = 80$~cm which was used in the machine throughout 2015 for proton-proton collisions and IR1/IR5 collimators were set to 13.7~$\sigma$. For both runs, a vertical crossing angle of $290~\mu$m was taken into account in the simulations. More simulation and run parameters can be found in Tab.~\ref{paramsRun12}. 

\begin{table}
   \centering
   \caption{Run I (2012) and Run II (2015) simulation parameters.}
   \begin{tabular}{l||c|c}
       \hline
       beam energy & 4 TeV & 6.5~TeV \\
       $\beta^*$ optics  & 60~cm &  80~cm \\
       bunch intensity & 1.4$\times 10^{11}$ protons &  1.2$\times 10^{11}$ protons\\
       number of bunches & 1380 & 2748\\
       bunch spacing & 50~ns & 25~ns\\
       half-crossing angle IP1~/~5 & 145~$\mu$rad & 145~$\mu$rad \\
       TCP.IR7~/~TCSG.IR7~/~TCT.IR1 & 4.3~/~6.3~/~9.0~$\sigma$ & 5.5~/~8.0~/~13.7~$\sigma$ \\
       \hline
   \end{tabular}
   \label{paramsRun12}
\end{table}


\subsection{HL-LHC Simulation Cases}

Several cases were simulated in order to characterise the cleaning efficiency for baseline settings of HL-LHC and variants and to estimate quantitatively any advantages in term of background with different collimator layouts. An alternative set of collimator openings, so called \twosigmaret~settings, was prepared based on experience with the machine and is listed in Tab.~\ref{HLcollSettings}. In particular, the aim was to quantify the effect of additional tertiary collimators, TCT5s, for incoming beams (B1 and B2). Inelastic interactions with beam protons are forced in \fluka~at initial conditions given by SixTrack on the TCT4s and (when included) TCT5s. These interactions generate a particle flux towards the experiment. All shower particles are recorded at the machine-detector interface plane at 22.6~m from the IP using in \fluka~a production and transportation cut-off at 20 MeV. Section~\ref{hllhcResults} is dedicated to all the HL simulation details.

\begin{table}[hbt]
   \centering
   \caption{HL half-gap collimator settings calculated for a normalised emittance of $\epsilon_{\mathrm{n}}$ of 3.5~$\mu$m. Full and updated settings can be found in~\cite{collSettRef}. If included, the TCT5s had the same settings as the TCT4s.}

   \begin{tabular}{l|c|c}
       \hline
       collimators &        nominal settings & $2\sigma$-retracted settings\\
                   &         [$\sigma$] &  [$\sigma$]\\
       \hline
       TCP3 & 12 (now 15) & 15 \\
       TCSG3 & 15.6 (now 18)& 18 \\
       TCP7 & 6 & 5.7 \\
       TCSG7 & 7 & 7.7 \\
       TCT4 IR1/5 & 8.3 & 10.5 \\
       \hline
   \end{tabular}
   \label{HLcollSettings}
\end{table}

\begin{table}[!hbt]
   \centering
   \caption{Simulation parameters for HL-LHC normalisation for $\beta^* =$15~cm ATS optics.}
   \begin{tabular}{l|c}
       \hline
       beam energy & 7 TeV \\
       bunch intensity & 2.2$\times 10^{11}$ protons\\
       bunch spacing & 25~ns \\
       number of bunches & 2736 \\
       \hline
   \end{tabular}
   \label{hlscenario}
\end{table}
